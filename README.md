# Public data, code, and notebooks for Erwin et al. (2021) paper on NGC 4608 and NGC 4643

This git repository contains data files, Python code, and Python Jupyter
notebooks which can be used to reproduce figures and analyses from the
paper ["Composite Bulges -- II. Classical Bulges and Nuclear Disks in
Barred Galaxies: The Contrasting Cases of NGC 4608 and NGC
4643"](https://www.mpe.mpg.de/~erwin/temp/n4608_n4643_paper.pdf) (Erwin et
al. 2021, *Monthly Notices of the Royal Astronomical Society*,
**502:** 2446-2473; [arXiv:2101.05321](https://arxiv.org/abs/2101.05321)).

**NOTE: THIS IS CURRENTLY AN INCOMPLPETE WORK IN PROGRESS!**

![NGC 4643: nuclear-disk kinematics](./n4643_MUSE-kinematics_single-row.png)

(This figure shows the near-IR morphology and stellar kinematics of the
nuclear-disk region inside the bar of the SB0/a galaxy NGC 4643.
Leftmost panel: *HST* WFC3-IR F160W isophotes. Other panels: VLT-MUSE
stellar kinematics for the same region, overlaid with isophotes from the
ratio image of our best-fitting model (solid contours = nuclear-disk
component is dominant). (See Section 5.2 and Figure 18 of the paper for
more details.))

[![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.4235501.svg)](https://doi.org/10.5281/zenodo.4235501)



## Dependencies

The Python code and notebooks require the following external Python modules and packages,
all of which are available on PyPI and can be installed via `pip`:

   * [Numpy](https://www.numpy.org), [Scipy](https://www.scipy.org), 
   [matplotlib](https://matplotlib.org), [Scikit-Image](https://scikit-image.org)


## Jupyter Notebooks

   * `n4608n4643_figures_for_paper.ipynb` -- generates the figures for the paper (including
   individual plots for multi-plot figures)

<!-- 
There are two Jupyter Python notebooks:

   * `barsize_fits.ipynb` -- generates (and saves to a text file) various fits

   * `barsizes_figures_for_paper.ipynb` -- generates the figures for the paper (using
   fit coefficients saved by the first notebook)
 -->


## Python Code

   * `plotutils.py` -- assorted functions used in generating figures

<!-- 
   * `datasets.py`, `datautils.py`, `plotutils.py`, `s4gutils.py` -- miscellaneous utility functions
   (including statistics).
   
   * `sample_defs.py` -- definitions of various subsamples of S4G galaxies, in the
   form of integer lists of index values (slices, more or less).
   
   * `fitting_barsizes.py` -- code to assist with the fits in the Jupyter notebook
   `barsize_fits.ipynb`.

   * `make_fit_tables.py` -- code to generate LaTeX tables for the paper
 -->


## Data Files

The `data/` subdirectory contains various subdirectories with *Spitzer*
IRAC1 and *HST* images of the two galaxies, corresponding mask and PSF
images, and model images generated by Imfit. Some images are rotated
from the observed (data) orientation so as to put N up and E to the
left.


## Imfit Configuration and Best-fit Parameter Files

	
The corresponding data, mask, and PSF images can be found in the `data/` subdirectory.


## Spectroscopy and Stellar-kinematics Data

SAURON stellar kinematics data from the ATLAS3D survey ([Cappellari et
al.
2011](https://ui.adsabs.harvard.edu/abs/2011MNRAS.413..813C/abstract))
for NGC 4608 and NGC 4643 is available
[here](http://www-astro.physics.ox.ac.uk/atlas3d/tables.html) (see the "2-dim Stellar 
Kinematics content" files).

(For NGC 4643, we also used multiple-pointing SAURON observations from
[Seidel et al. (2015)](https://ui.adsabs.harvard.edu/abs/2015MNRAS.451..936S/abstract);
please contact Dr. Marja Seidel for access to the reduced data.)

The ESO [Phase 3](https://www.eso.org/sci/observing/phase3.html)
pipeline-reduced MUSE datacube for NGC 4643 [REF] can be obtained via the
[Phase 3 Data Products search form](http://archive.eso.org/wdb/wdb/adp/phase3_main/query).
Our kinematic analysis of this datacube is available upon reasonable request.



## How to Generate Figures from the Paper

1. Download this repository.

2. Edit paths in the notebooks so they point to the correct locations on your
system, if necessary. See notes in the initial cells of the notebooks. 
Also make sure to set `savePlots = True`
if you want the PDF files to actually be generated (the default is `False`, which
means the figures will appear in the notebook but won't be saved to disk).

3. Run the notebook `barsizes_figures_for_paper.ipynb` to generate the figures.

<!-- 
1. Download this repository.

2. Edit paths in the notebooks so they point to the correct locations on your
system, if necessary. See notes in the initial cells of the notebooks. 
Also make sure to set `savePlots = True`
if you want the PDF files to actually be generated (the default is `False`, which
means the figures will appear in the notebook but won't be saved to disk).

3. **Optionally:** Run the notebook `barsize_fits.ipynb` to generate and
save the various fits. (Note that MSE_pred values and parameter
uncertainties may change slightly, since they are based on bootstrap
resampling.) This is "optional" in that the output files already exist
in this directory (they will be overwritten if the notebook is run).

4. Run the notebook `n4608n4643_figures_for_paper.ipynb` to generate the figures.
(it will read the coefficients of the fits from the file generated by running the
previous notebook).
 -->


## Licensing

Code in this repository is released under the BSD 3-clause license.

<a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
<img alt="Creative Commons License" style="border-width:0" 
src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a><br />
Text and figures are licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
